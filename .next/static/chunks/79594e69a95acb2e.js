(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78928,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(18566),l=e.i(38938),r=e.i(54858),i=e.i(67881);let d=({variant:e="default",className:a="",...t})=>(0,s.jsx)(i.Button,{variant:{primary:"default",success:"default",danger:"destructive",ghost:"ghost",secondary:"secondary"}[e]||e,className:a,...t});var o=e.i(47163);function n({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,o.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}let c=({children:e,className:a="",...t})=>(0,s.jsx)(n,{className:(0,o.cn)("bg-white rounded-xl border border-slate-100 p-5 shadow-sm hover:shadow-md transition-all duration-300",a),...t,children:e});var x=e.i(91918);let m=(0,e.i(25913).cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function u({className:e,variant:a,asChild:t=!1,...l}){let r=t?x.Slot:"span";return(0,s.jsx)(r,{"data-slot":"badge",className:(0,o.cn)(m({variant:a}),e),...l})}let h=({status:e})=>(0,s.jsx)(u,{variant:"outline",className:{PENDIENTE:"bg-orange-100 text-orange-700 border-orange-200",OFERTANDO:"bg-blue-100 text-blue-700 border-blue-200",EN_PROCESO:"bg-purple-100 text-purple-700 border-purple-200",FINALIZADA:"bg-emerald-100 text-emerald-700 border-emerald-200",CANCELADA:"bg-gray-100 text-gray-500 border-gray-200"}[e]||"bg-gray-100",children:e});var b=e.i(37727),p=e.i(98919),f=e.i(75254);let j=(0,f.default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),g=(0,f.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var N=e.i(61086);let v=({worker:e,onClose:t,user:l})=>{let[i,o]=(0,a.useState)([]),[n,c]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{e?.usuario?.id&&(0,r.apiCall)({endpoint:`/resenas/usuario/${e.usuario.id}`,method:"GET"}).then(o).finally(()=>c(!1))},[e]),(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col shadow-2xl",children:[(0,s.jsxs)("div",{className:"bg-slate-900 text-white p-6 relative",children:[(0,s.jsx)("button",{onClick:t,className:"absolute top-4 right-4 p-1 hover:bg-white/10 rounded-full",children:(0,s.jsx)(b.X,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-indigo-500 rounded-full flex items-center justify-center text-2xl font-bold border-4 border-white/10",children:e.usuario.nombreCompleto.charAt(0)}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[e.usuario.nombreCompleto,e.verificado&&(0,s.jsx)(p.Shield,{className:"w-4 h-4 text-emerald-400 fill-current"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-yellow-400 text-sm font-medium mt-1",children:[(0,s.jsx)(j,{className:"w-4 h-4 fill-current"})," ",e.calificacionPromedio]})]})]})]}),(0,s.jsxs)("div",{className:"p-6 overflow-y-auto",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-2",children:"Biografía"}),(0,s.jsx)("p",{className:"text-slate-700 bg-slate-50 p-4 rounded-xl text-sm leading-relaxed",children:e.biografia||"Sin biografía disponible."})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,s.jsx)(g,{className:"w-4 h-4"})," Comentarios (",i.length,")"]}),n?(0,s.jsx)("div",{className:"text-center py-4",children:(0,s.jsx)(N.Loader,{className:"w-6 h-6 animate-spin mx-auto text-indigo-600"})}):0===i.length?(0,s.jsx)("p",{className:"text-slate-500 text-sm italic",children:"Sin reseñas."}):(0,s.jsx)("div",{className:"space-y-3",children:i.map(e=>(0,s.jsxs)("div",{className:"border-b border-slate-100 pb-3 last:border-0",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,s.jsx)("span",{className:"font-bold text-sm text-slate-800",children:e.autor.nombreCompleto}),(0,s.jsx)("span",{className:"text-xs text-slate-400",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,s.jsx)("div",{className:"flex text-yellow-400 w-3 h-3 gap-0.5 mb-1",children:[...Array(e.calificacion)].map((e,a)=>(0,s.jsx)(j,{className:"w-3 h-3 fill-current"},a))}),(0,s.jsxs)("p",{className:"text-sm text-slate-600",children:['"',e.comentario,'"']})]},e.id))})]})]}),(0,s.jsx)("div",{className:"p-4 border-t bg-slate-50 text-center",children:(0,s.jsx)(d,{variant:"secondary",onClick:t,className:"w-full",children:"Cerrar Perfil"})})]})})},y=({reqId:e,onClose:t,user:l,onAccept:i})=>{let[o,n]=(0,a.useState)([]),[c,x]=(0,a.useState)(null);(0,a.useEffect)(()=>{(0,r.apiCall)({endpoint:`/ofertas/solicitud/${e}`,method:"GET"}).then(n).catch(console.error)},[e]);let m=async e=>{confirm("¿Aceptar esta oferta?")&&(await (0,r.apiCall)({endpoint:`/ofertas/${e}/aceptar`,method:"PUT"}),alert("Oferta Aceptada"),i(),t())};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg p-6 max-h-[80vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-bold",children:"Ofertas Recibidas"}),(0,s.jsx)("button",{onClick:t,children:(0,s.jsx)(b.X,{})})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[o.map(e=>(0,s.jsxs)("div",{className:"border p-4 rounded-xl hover:border-indigo-200 transition-all bg-slate-50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>{console.log("Selected worker data:",e.trabajador),x(e.trabajador)},children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-indigo-600 text-white flex items-center justify-center font-bold",children:e.trabajador.usuario.nombreCompleto.charAt(0)}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-bold text-sm text-slate-800 group-hover:text-indigo-600 transition-colors flex items-center gap-1",children:[e.trabajador.usuario.nombreCompleto,e.trabajador.verificado&&(0,s.jsx)(p.Shield,{className:"w-3 h-3 text-emerald-500 fill-current"})]}),(0,s.jsxs)("div",{className:"flex text-xs text-yellow-500",children:[(0,s.jsx)(j,{className:"w-3 h-3 fill-current"})," ",e.trabajador.calificacionPromedio]})]})]}),(0,s.jsxs)("span",{className:"font-bold text-lg text-emerald-600",children:["S/. ",e.montoOfrecido]})]}),(0,s.jsxs)("p",{className:"text-sm text-slate-600 italic mb-3",children:['"',e.comentario,'"']}),(0,s.jsx)(d,{onClick:()=>m(e.id),variant:"success",className:"w-full text-xs py-2",children:"Aceptar y Contratar"})]},e.id)),0===o.length&&(0,s.jsx)("p",{className:"text-center text-slate-400 py-4",children:"Aún no hay ofertas."})]})]})}),c&&(0,s.jsx)(v,{worker:c,onClose:()=>x(null),user:l})]})},w=(0,f.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),C=async e=>new Promise(s=>setTimeout(()=>s(`(IA): Descripci\xf3n mejorada para: "${e}"`),1e3)),k=({userId:e,categories:t,editingId:l,initialForm:i,onSuccess:o,onCancel:n})=>{let[c,x]=(0,a.useState)(i||{catId:1,desc:"",price:"",addr:"",lat:-8.11,lng:-79.03}),[m,u]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),f=async()=>{if(!c.desc)return;u(!0);let e=`Mejora esta descripci\xf3n corta para una solicitud de trabajo en casa (s\xe9 conciso, profesional y claro): "${c.desc}"`,s=await C(e);s&&x({...c,desc:s}),u(!1)},j=async s=>{s.preventDefault(),p(!0);try{let s={categoriaId:c.catId,descripcion:c.desc,precioSugerido:Number.parseFloat(c.price),direccion:c.addr,referencia:"Web",latitud:c.lat,longitud:c.lng};l?(await (0,r.apiCall)({endpoint:`/solicitudes/${l}?clienteId=${e}`,method:"PUT",body:s}),alert("Solicitud Actualizada")):(await (0,r.apiCall)({endpoint:`/solicitudes?clienteId=${e}`,method:"POST",body:s}),alert("Solicitud Creada")),o()}catch(e){alert("Error al crear la solicitud"),console.error(e)}finally{p(!1)}};return(0,s.jsxs)("div",{className:"bg-white rounded-3xl border border-slate-100 p-8 shadow-sm max-w-3xl mx-auto animate-in fade-in zoom-in duration-300",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:l?"Editar Solicitud":"Crear Solicitud"}),(0,s.jsx)("button",{onClick:n,className:"p-2 hover:bg-slate-50 rounded-full text-slate-400",children:(0,s.jsx)(b.X,{className:"w-5 h-5"})})]}),(0,s.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-bold text-slate-700 block mb-3",children:"Selecciona Categoría"}),(0,s.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2",children:t.map(e=>(0,s.jsxs)("div",{onClick:()=>x({...c,catId:e.id}),className:`cursor-pointer min-w-[120px] p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${c.catId===e.id?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-slate-100 hover:border-slate-300"}`,children:[(0,s.jsx)("img",{src:e.urlIcono||"/placeholder.svg",className:"w-8 h-8 opacity-75",onError:e=>e.currentTarget.src="https://cdn-icons-png.flaticon.com/512/1087/1087815.png",alt:e.nombre}),(0,s.jsx)("span",{className:"text-xs font-bold",children:e.nombre})]},e.id))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-end mb-2",children:[(0,s.jsx)("label",{className:"text-sm font-bold text-slate-700",children:"Descripción"}),(0,s.jsxs)("button",{type:"button",onClick:f,disabled:m,className:"text-xs text-indigo-600 font-bold flex items-center gap-1 hover:text-indigo-700 disabled:opacity-50",children:[(0,s.jsx)(w,{className:"w-3 h-3"})," ",m?"Generando...":"Mejorar con IA"]})]}),(0,s.jsx)("textarea",{required:!0,className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none resize-none transition-all",rows:3,onChange:e=>x({...c,desc:e.target.value}),value:c.desc,placeholder:"Describe el servicio que necesitas..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-bold text-slate-700 block mb-2",children:"Precio (S/.)"}),(0,s.jsx)("input",{required:!0,type:"number",className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",onChange:e=>x({...c,price:e.target.value}),value:c.price,placeholder:"0.00"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-bold text-slate-700 block mb-2",children:"Dirección"}),(0,s.jsx)("input",{required:!0,type:"text",className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",onChange:e=>x({...c,addr:e.target.value}),value:c.addr,placeholder:"Tu dirección..."})]})]}),(0,s.jsxs)("div",{className:"pt-4 flex justify-end gap-3",children:[(0,s.jsx)(d,{variant:"ghost",onClick:n,children:"Cancelar"}),(0,s.jsxs)(d,{type:"submit",disabled:h,children:[h?(0,s.jsx)(N.Loader,{className:"w-4 h-4 animate-spin"}):null,l?"Guardar Cambios":"Publicar Ahora"]})]})]})]})},A=(0,f.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),S=(0,f.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),I=(0,f.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),E=(0,f.default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),P=(0,f.default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),T=(0,f.default)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),D=({requestId:e,amount:t,onClose:l,onPaymentSuccess:r})=>{let[i,o]=(0,a.useState)(null),[n,c]=(0,a.useState)(!1),x=[{id:"card",name:"Tarjeta de Crédito/Débito",icon:E,description:"Visa, Mastercard, American Express"},{id:"yape",name:"Yape",icon:P,description:"Pago por teléfono"},{id:"transfer",name:"Transferencia Bancaria",icon:T,description:"Transferencia a cuenta bancaria"}],m=async()=>{i?(c(!0),setTimeout(()=>{alert(`Pago de S/. ${t} procesado con ${i}`),r(),l()},1500)):alert("Selecciona un método de pago")};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl animate-in slide-in-from-bottom-4",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:"Selecciona Método de Pago"}),(0,s.jsx)("button",{onClick:l,className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,s.jsx)(b.X,{className:"w-5 h-5 text-slate-400"})})]}),(0,s.jsx)("div",{className:"p-6 space-y-3",children:x.map(e=>{let a=e.icon;return(0,s.jsxs)("button",{onClick:()=>o(e.id),className:`w-full p-4 rounded-xl border-2 transition-all flex items-start gap-3 text-left ${i===e.id?"border-indigo-600 bg-indigo-50":"border-slate-200 hover:border-indigo-300"}`,children:[(0,s.jsx)(a,{className:"w-5 h-5 text-indigo-600 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-slate-800",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:e.description})]})]},e.id)})}),(0,s.jsxs)("div",{className:"p-6 bg-slate-50 border-t border-slate-100 rounded-b-2xl",children:[(0,s.jsxs)("div",{className:"mb-4 p-4 bg-white rounded-lg border border-slate-200",children:[(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Monto a pagar"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:["S/. ",t]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d,{variant:"ghost",onClick:l,className:"flex-1",children:"Cancelar"}),(0,s.jsx)(d,{onClick:m,disabled:n,className:"flex-1",children:n?"Procesando...":"Confirmar Pago"})]})]})]})})},z=({workerUsuarioId:e,workerName:t,requestId:l,onClose:r,onSubmit:i})=>{let[o,n]=(0,a.useState)(0),[c,x]=(0,a.useState)(""),[m,u]=(0,a.useState)(!1),h=async()=>{0===o?alert("Selecciona una calificación"):(u(!0),setTimeout(()=>{i(o,c),u(!1),r()},800))};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl animate-in slide-in-from-bottom-4",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:"Calificar Trabajo"}),(0,s.jsxs)("p",{className:"text-sm text-slate-500",children:["Servicio de ",t]})]}),(0,s.jsx)("button",{onClick:r,className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,s.jsx)(b.X,{className:"w-5 h-5 text-slate-400"})})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-3",children:"Calificación"}),(0,s.jsx)("div",{className:"flex gap-2 justify-center",children:[1,2,3,4,5].map(e=>(0,s.jsx)("button",{onClick:()=>n(e),className:"transition-transform hover:scale-110",children:(0,s.jsx)(j,{className:`w-8 h-8 ${e<=o?"fill-yellow-400 text-yellow-400":"text-slate-300"}`})},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Comentario"}),(0,s.jsx)("textarea",{value:c,onChange:e=>x(e.target.value),placeholder:"Cuéntanos sobre tu experiencia con este trabajador...",className:"w-full p-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none",rows:4}),(0,s.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:[c.length,"/500"]})]})]}),(0,s.jsxs)("div",{className:"p-6 bg-slate-50 border-t border-slate-100 rounded-b-2xl flex gap-2",children:[(0,s.jsx)(d,{variant:"ghost",onClick:r,className:"flex-1",children:"Cancelar"}),(0,s.jsx)(d,{onClick:h,disabled:m||0===o,className:"flex-1",children:m?"Enviando...":"Enviar Calificación"})]})]})})},O=()=>{let{user:e,logout:t}=(0,l.useAuth)(),[i,o]=(0,a.useState)("list"),[n,x]=(0,a.useState)([]),[m,u]=(0,a.useState)([]),[b,p]=(0,a.useState)(null),[f,j]=(0,a.useState)(null),[g,N]=(0,a.useState)(null),[v,w]=(0,a.useState)(null),[C,E]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!e||!e.usuarioId){console.warn("Usuario sin ID detectado. Cerrando sesión para limpiar cache."),t();return}P()},[e]);let P=()=>{e?.usuarioId&&((0,r.apiCall)({endpoint:"/categorias"}).then(x),(0,r.apiCall)({endpoint:`/solicitudes/mis-pedidos?clienteId=${e.usuarioId}`,method:"GET"}).then(u))},T=async s=>{if(confirm("¿Estás seguro de eliminar esta solicitud?")&&e?.usuarioId)try{await (0,r.apiCall)({endpoint:`/solicitudes/${s}?clienteId=${e.usuarioId}`,method:"DELETE"}),P()}catch(e){alert("Error al eliminar")}},O=async s=>{if(e)try{await (0,r.apiCall)({endpoint:`/solicitudes/${s}/finalizar?clienteId=${e.usuarioId}`,method:"PUT"});let a=m.find(e=>e.id===s);a&&a.trabajadorElegido&&a.trabajadorElegido.usuario?E({requestId:s,workerUsuarioId:a.trabajadorElegido.usuario.id,workerName:a.trabajadorElegido.usuario.nombreCompleto||"Trabajador"}):P()}catch(e){console.error("Error al finalizar la solicitud:",e),alert("Hubo un error al finalizar la solicitud. Por favor, recarga la página.")}},$=async(e,s)=>{if(C)try{await (0,r.apiCall)({endpoint:"/resenas",method:"POST",body:{solicitudId:C.requestId,usuarioCalificadoId:C.workerUsuarioId,estrellas:e,comentario:s}}),E(null),P()}catch(e){alert("Error al enviar la calificación")}};return(0,s.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-sm flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-slate-800",children:["Hola, ",e?.nombreCompleto?.split(" ")[0]||"Usuario"]}),(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"Gestiona tus servicios."})]}),(0,s.jsx)(d,{onClick:()=>{j(null),N(null),o("create")},children:"+ Nueva Solicitud"})]}),(0,s.jsxs)("div",{className:"flex gap-6 border-b border-slate-200",children:[(0,s.jsx)("button",{onClick:()=>o("list"),className:`pb-3 text-sm font-bold border-b-2 transition-colors ${"list"===i?"border-indigo-600 text-indigo-600":"border-transparent text-slate-500"}`,children:"Activos"}),(0,s.jsx)("button",{onClick:()=>o("history"),className:`pb-3 text-sm font-bold border-b-2 transition-colors ${"history"===i?"border-indigo-600 text-indigo-600":"border-transparent text-slate-500"}`,children:"Historial Completo"})]}),"create"===i&&e?(0,s.jsx)(k,{userId:e.usuarioId,categories:n,editingId:f,initialForm:g,onSuccess:()=>{o("list"),j(null),N(null),P()},onCancel:()=>{o("list"),j(null),N(null)}}):"create"!==i||e?(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[("list"===i?m.filter(e=>"FINALIZADA"!==e.estado&&"CANCELADA"!==e.estado):m.filter(e=>"FINALIZADA"===e.estado||"CANCELADA"===e.estado)).map(e=>(0,s.jsxs)(c,{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)(h,{status:e.estado}),(0,s.jsxs)("span",{className:"text-xs text-slate-400",children:["#",e.id]})]}),(0,s.jsx)("h3",{className:"font-bold text-slate-800",children:e.descripcion}),(0,s.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:e.direccion}),(0,s.jsxs)("div",{className:"flex gap-2 text-xs text-slate-400 mb-4",children:[(0,s.jsx)(I,{className:"w-3 h-3"})," ",(0,s.jsx)("span",{children:e.createdAt||"Hoy"})]}),(0,s.jsxs)("div",{className:"pt-4 border-t flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-bold text-indigo-600",children:["S/. ",e.precioSugerido]}),(0,s.jsxs)("div",{className:"flex gap-2",children:["PENDIENTE"===e.estado&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{j(e.id),N({catId:e.categoriaId||1,desc:e.descripcion,price:e.precioSugerido,addr:e.direccion,lat:e.latitud||-8.11,lng:e.longitud||-79.03}),o("create")},className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:(0,s.jsx)(A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>T(e.id),className:"p-2 hover:bg-rose-50 rounded-full text-rose-500",children:(0,s.jsx)(S,{className:"w-4 h-4"})})]}),"OFERTANDO"===e.estado&&(0,s.jsx)(d,{variant:"secondary",className:"text-xs h-8",onClick:()=>p(e.id),children:"Ver Ofertas"}),"FINALIZADO_POR_TRABAJADOR"===e.estado&&(0,s.jsx)(d,{variant:"success",className:"text-xs h-8",onClick:()=>w(e.id),children:"Pagar y Finalizar"})]})]})]},e.id)),m.length>0&&0===("list"===i?m.filter(e=>"FINALIZADA"!==e.estado&&"CANCELADA"!==e.estado):m.filter(e=>"FINALIZADA"===e.estado||"CANCELADA"===e.estado)).length&&(0,s.jsx)("div",{className:"col-span-2 text-center py-10 border-2 border-dashed border-slate-200 rounded-xl",children:(0,s.jsx)("p",{className:"text-slate-400",children:"No hay solicitudes en esta sección."})})]}):(0,s.jsx)("div",{className:"col-span-2 text-center py-10 border-2 border-dashed border-slate-200 rounded-xl",children:(0,s.jsx)("p",{className:"text-slate-400",children:"Inicia sesión para crear una solicitud."})}),b&&e&&(0,s.jsx)(y,{reqId:b,onClose:()=>p(null),user:e,onAccept:P}),v&&(0,s.jsx)(D,{requestId:v,amount:m.find(e=>e.id===v)?.precioSugerido||0,onClose:()=>w(null),onPaymentSuccess:()=>O(v)}),C&&(0,s.jsx)(z,{requestId:C.requestId,workerUsuarioId:C.workerUsuarioId,workerName:C.workerName,onClose:()=>E(null),onSubmit:$})]})},$=({solicitudId:e,onClose:t,onSubmit:l})=>{let[r,i]=(0,a.useState)(""),[o,n]=(0,a.useState)("");return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h3",{className:"font-bold text-lg",children:"Enviar Mi Oferta"}),(0,s.jsx)("button",{onClick:t,className:"text-slate-500 hover:text-slate-800",children:(0,s.jsx)(b.X,{size:24})})]}),(0,s.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),r)?l({montoOfrecido:parseFloat(r),comentario:o}):alert("Por favor, ingresa un monto.")},className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"montoOfrecido",className:"block text-sm font-medium text-slate-700 mb-1",children:"¿Cuánto quieres cobrar? (S/.)"}),(0,s.jsx)("input",{type:"number",id:"montoOfrecido",value:r,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Ej: 80.00",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"comentario",className:"block text-sm font-medium text-slate-700 mb-1",children:"Comentario (Opcional)"}),(0,s.jsx)("textarea",{id:"comentario",value:o,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Ej: Tengo experiencia y herramientas. Puedo empezar ahora mismo.",rows:3})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(d,{type:"button",variant:"ghost",onClick:t,children:"Cancelar"}),(0,s.jsx)(d,{type:"submit",variant:"success",children:"Enviar Oferta"})]})]})]})})},L=(0,f.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),M=(0,f.default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),F=({solicitudId:e,onClose:t,onSuccess:l})=>{let[i,o]=(0,a.useState)(!1),[n,c]=(0,a.useState)(null),x=async()=>{o(!0),c(null);try{let s=await new Promise(e=>setTimeout(()=>e({lat:-8.11,lng:-79.03}),500)),a=await (0,r.apiCall)({endpoint:"/biometria/verificar",method:"POST",body:{solicitudId:e,latitudActual:s.lat,longitudActual:s.lng,fotoSelfieUrl:"https://this-person-does-not-exist.com/img/avatar-1126a908256a7e1329a3512b963155d0.jpg"}});if(a.exito)alert("Verificación biométrica exitosa."),l(e),t();else throw Error(a.mensaje||"La verificación biométrica ha fallado.")}catch(e){c(e.message||"Ocurrió un error inesperado durante la verificación.")}finally{o(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl animate-in slide-in-from-bottom-4",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:"Verificación de Identidad"}),(0,s.jsx)("button",{onClick:t,className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,s.jsx)(b.X,{className:"w-5 h-5 text-slate-400"})})]}),(0,s.jsxs)("div",{className:"p-6 text-center",children:[(0,s.jsx)("p",{className:"text-slate-600 mb-6",children:"Para garantizar la seguridad, por favor completa una verificación rápida antes de iniciar el trabajo."}),(0,s.jsxs)("div",{className:"flex justify-center gap-8 text-slate-500 mb-8",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(L,{className:"w-8 h-8"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Selfie Rápida"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(M,{className:"w-8 h-8"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Ubicación GPS"})]})]}),n&&(0,s.jsx)("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-lg mb-4",children:n}),(0,s.jsx)(d,{onClick:x,disabled:i,className:"w-full",children:i?(0,s.jsx)(N.Loader,{className:"w-5 h-5 animate-spin"}):"Iniciar Verificación"})]})]})})},R=(0,f.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),q=(0,f.default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),U=(0,f.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),V=({jobs:e,onJobAction:a,isHistory:t=!1})=>0===e.length?(0,s.jsx)("div",{className:"text-center py-10 border-2 border-dashed border-slate-200 rounded-xl",children:(0,s.jsx)("p",{className:"text-slate-400",children:t?"No tienes trabajos en tu historial.":"No tienes trabajos aceptados por el momento."})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,s.jsxs)(c,{className:"bg-white",children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsxs)("span",{className:"text-xs bg-slate-100 px-2 py-1 rounded font-bold",children:["#",e.id]}),(0,s.jsxs)("span",{className:"font-bold text-emerald-600",children:["S/. ",e.precioSugerido]})]}),(0,s.jsx)("h4",{className:"font-bold text-slate-800 mb-2",children:e.descripcion}),(0,s.jsxs)("div",{className:"text-sm text-slate-500 space-y-2 mt-4 pt-4 border-t",children:[(0,s.jsxs)("p",{className:"flex items-center gap-2",children:[(0,s.jsx)(M,{className:"w-4 h-4 text-slate-400"})," ",e.direccion]}),(0,s.jsxs)("p",{className:"flex items-center gap-2",children:[(0,s.jsx)(R,{className:"w-4 h-4 text-slate-400"})," ",e.cliente?.nombreCompleto||"Cliente Anónimo"]}),(0,s.jsxs)("p",{className:"flex items-center gap-2",children:[(0,s.jsx)(q,{className:"w-4 h-4 text-slate-400"})," ",e.cliente?.telefono||"No disponible"]})]}),(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t",children:["ACEPTADO"===e.estado&&(0,s.jsx)(d,{className:"w-full",onClick:()=>a("start",e.id),children:"Iniciar Trabajo"}),"EN_PROCESO"===e.estado&&(0,s.jsx)(d,{className:"w-full",variant:"success",onClick:()=>a("finish",e.id),children:"Finalizar Trabajo"}),("FINALIZADA"===e.estado||"FINALIZADO_POR_TRABAJADOR"===e.estado)&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-emerald-600 font-bold py-2",children:[(0,s.jsx)(U,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Trabajo Completado"})]}),"CANCELADA"===e.estado&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-rose-600 font-bold py-2",children:[(0,s.jsx)(b.X,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Cancelado"})]})]})]},e.id))}),H=()=>{let{user:e}=(0,l.useAuth)(),[t,i]=(0,a.useState)([]),[o,n]=(0,a.useState)([]),[x,m]=(0,a.useState)(null),[u,h]=(0,a.useState)("disponibles"),[b,p]=(0,a.useState)(!1),[f,g]=(0,a.useState)(null),[N,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{e?.usuarioId&&y()},[e]);let y=()=>{e?.usuarioId&&Promise.all([(0,r.apiCall)({endpoint:"/solicitudes/disponibles"}),(0,r.apiCall)({endpoint:`/solicitudes/mis-trabajos?usuarioId=${e.usuarioId}`}),(0,r.apiCall)({endpoint:`/trabajadores/usuario/${e.usuarioId}`})]).then(([e,s,a])=>{i(e),n(s),m(a)}).catch(e=>console.error("Error fetching worker data:",e))},w=()=>{g(null),p(!1)},C=async s=>{if(f&&e)try{await (0,r.apiCall)({endpoint:`/ofertas?trabajadorUsuarioId=${e.usuarioId}`,method:"POST",body:{solicitudId:f,...s}}),alert("¡Oferta enviada con éxito!"),w(),y()}catch(e){console.error("Error al enviar la oferta:",e),alert("Hubo un error al enviar tu oferta.")}},k=async s=>{if(e)try{await (0,r.apiCall)({endpoint:`/solicitudes/${s}/iniciar?trabajadorUsuarioId=${e.usuarioId}`,method:"PUT"}),alert("Trabajo iniciado. ¡Buena suerte!"),y()}catch(e){console.error("Error al iniciar trabajo:",e),alert("No se pudo iniciar el trabajo.")}},A=async s=>{if(e)try{await (0,r.apiCall)({endpoint:`/solicitudes/${s}/trabajador-finalizar?trabajadorUsuarioId=${e.usuarioId}`,method:"PUT"}),alert("¡Trabajo marcado como finalizado! El cliente será notificado para realizar el pago."),y()}catch(e){console.error("Error al finalizar trabajo:",e),alert("No se pudo finalizar el trabajo.")}},S=o.filter(e=>"ACEPTADO"===e.estado||"EN_PROCESO"===e.estado),I=o.filter(e=>"FINALIZADO_POR_TRABAJADOR"===e.estado||"FINALIZADA"===e.estado||"CANCELADA"===e.estado);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-slate-900 text-white p-6 rounded-2xl",children:[(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"Ganancias"}),(0,s.jsx)("h3",{className:"text-3xl font-bold",children:"S/. 450"})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl border shadow-sm",children:[(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"Calificación"}),(0,s.jsxs)("h3",{className:"text-3xl font-bold text-slate-800 flex items-center gap-2",children:[(0,s.jsx)(j,{className:"w-7 h-7 text-yellow-400"}),x?.calificacionPromedio?.toFixed(1)||"N/A"]})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-2xl border shadow-sm",children:[(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"Trabajos Completados"}),(0,s.jsx)("h3",{className:"text-3xl font-bold text-slate-800",children:x?.trabajosCompletados||0})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 border-b",children:[(0,s.jsx)("button",{onClick:()=>h("disponibles"),className:`px-4 py-2 font-medium transition-colors ${"disponibles"===u?"text-indigo-600 border-b-2 border-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:"Disponibles"}),(0,s.jsxs)("button",{onClick:()=>h("aceptados"),className:`px-4 py-2 font-medium transition-colors relative ${"aceptados"===u?"text-indigo-600 border-b-2 border-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:["Mis Trabajos",S.length>0&&(0,s.jsx)("span",{className:"ml-2 bg-indigo-600 text-white text-xs rounded-full px-2 py-0.5",children:S.length})]}),(0,s.jsx)("button",{onClick:()=>h("historial"),className:`px-4 py-2 font-medium transition-colors ${"historial"===u?"text-indigo-600 border-b-2 border-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:"Historial"})]}),"disponibles"===u&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.map(e=>(0,s.jsxs)(c,{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsxs)("span",{className:"text-xs bg-slate-100 px-2 py-1 rounded font-bold",children:["#",e.id]}),(0,s.jsxs)("span",{className:"font-bold text-emerald-600",children:["S/. ",e.precioSugerido]})]}),(0,s.jsx)("h4",{className:"font-bold text-slate-800 mb-2",children:e.descripcion}),(0,s.jsxs)("p",{className:"text-sm text-slate-500 mb-4 flex items-center gap-1",children:[(0,s.jsx)(M,{className:"w-3 h-3"})," ",e.direccion]}),(0,s.jsx)(d,{className:"w-full",onClick:()=>{g(e.id),p(!0)},children:"Postularme"})]},e.id)),0===t.length&&(0,s.jsx)("p",{className:"col-span-full text-center py-8 text-slate-400",children:"No hay trabajos disponibles."})]}),"aceptados"===u&&(0,s.jsx)(V,{jobs:S,onJobAction:(e,s)=>{switch(e){case"start":v(s);break;case"finish":A(s)}}}),"historial"===u&&(0,s.jsx)(V,{jobs:I,onJobAction:()=>{},isHistory:!0})]}),b&&f&&(0,s.jsx)($,{solicitudId:f,onClose:w,onSubmit:C}),N&&(0,s.jsx)(F,{solicitudId:N,onClose:()=>v(null),onSuccess:k})]})},B=()=>{let{user:e,activeRole:t}=(0,l.useAuth)(),[i,o]=(0,a.useState)([]),[n,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{t&&(0,r.apiCall)({endpoint:`/suscripciones/planes?rol=${t}`}).then(o)},[t]);let x=async s=>{let a=s||n?.id;if(!a||!e)return void alert("Error: No se pudo determinar el plan o el usuario.");try{await (0,r.apiCall)({endpoint:`/suscripciones/suscribir?usuarioId=${e.usuarioId}`,method:"POST",body:{planId:a,meses:1}}),alert("¡Suscripción activada con éxito!"),c(null)}catch(e){console.error("Error al suscribirse:",e),alert("Hubo un error al procesar tu suscripción.")}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"max-w-5xl mx-auto p-4",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-center mb-8",children:["Planes para ","TRABAJADOR"===t?"Profesionales":"Clientes"]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:i.map(e=>(0,s.jsxs)("div",{className:`bg-white p-8 rounded-3xl border transition-all ${e.recomendado?"border-indigo-500 shadow-xl scale-105":"border-slate-200"}`,children:[(0,s.jsx)("h3",{className:"font-bold text-xl text-slate-800",children:e.nombre}),(0,s.jsxs)("div",{className:"my-4 flex items-baseline gap-1",children:[(0,s.jsxs)("span",{className:"text-4xl font-black text-slate-900",children:["S/.",e.precio]}),(0,s.jsx)("span",{className:"text-sm text-slate-500",children:e.periodo})]}),(0,s.jsx)("ul",{className:"space-y-2 mb-8",children:e.features.split("|").map((e,a)=>(0,s.jsxs)("li",{className:"flex gap-2 text-sm text-slate-600",children:[(0,s.jsx)(U,{className:"w-4 h-4 text-emerald-500"})," ",e]},a))}),(0,s.jsx)(d,{className:"w-full",variant:e.recomendado?"primary":"secondary",onClick:()=>{0===e.precio?x(e.id):c(e)},children:0===e.precio?"Activar Gratis":"Seleccionar"})]},e.id))})]}),n&&(0,s.jsx)(D,{requestId:n.id,amount:n.precio,onClose:()=>c(null),onPaymentSuccess:()=>x()})]})},Z=()=>{let{user:e,activeRole:t}=(0,l.useAuth)(),[i,o]=(0,a.useState)(null),[n,c]=(0,a.useState)([]),[x,m]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{e?.usuarioId&&e.esTrabajador?(m(!0),Promise.all([(0,r.apiCall)({endpoint:`/trabajadores/usuario/${e.usuarioId}`}),(0,r.apiCall)({endpoint:`/resenas/usuario/${e.usuarioId}`})]).then(([e,s])=>{o(e),c(s)}).catch(e=>console.error("Error fetching worker profile:",e)).finally(()=>m(!1))):m(!1)},[e]),(0,s.jsx)("div",{className:"max-w-4xl mx-auto p-4 animate-in fade-in",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"h-32 bg-gradient-to-r from-indigo-500 to-purple-600"}),(0,s.jsxs)("div",{className:"px-8 pb-8",children:[(0,s.jsxs)("div",{className:"relative flex justify-between items-end -mt-12 mb-6",children:[(0,s.jsx)("div",{className:"w-24 h-24 bg-white p-1 rounded-full shadow-lg",children:(0,s.jsx)("div",{className:"w-full h-full bg-slate-200 rounded-full flex items-center justify-center text-3xl font-bold text-slate-500",children:e?.nombreCompleto?.charAt(0)})}),(0,s.jsx)(d,{variant:"secondary",children:"Editar Perfil"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:e?.nombreCompleto}),(0,s.jsx)("p",{className:"text-slate-500",children:e?.email}),(0,s.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded font-bold",children:t}),e?.esTrabajador&&i?.verificado&&(0,s.jsxs)("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded font-bold flex items-center gap-1",children:[(0,s.jsx)(p.Shield,{className:"w-3 h-3"})," Verificado"]})]})]}),e?.esTrabajador&&(0,s.jsx)("div",{className:"mt-8 pt-8 border-t border-slate-100",children:x?(0,s.jsx)("div",{className:"text-center py-4",children:(0,s.jsx)(N.Loader,{className:"w-6 h-6 animate-spin mx-auto text-indigo-600"})}):i?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Estadísticas de Trabajador"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Calificación"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-indigo-600 flex items-center gap-2",children:[(0,s.jsx)(j,{className:"w-5 h-5 text-yellow-400"}),i.calificacionPromedio?.toFixed(1)||"N/A"]})]}),(0,s.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Trabajos Completados"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:i.trabajosCompletados||0})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-bold text-lg mb-4",children:"Biografía"}),(0,s.jsx)("p",{className:"text-slate-700 bg-slate-50 p-4 rounded-xl text-sm leading-relaxed",children:i.biografia||"No has establecido una biografía todavía."})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[(0,s.jsx)(g,{className:"w-5 h-5"})," Comentarios Recibidos (",n.length,")"]}),0===n.length?(0,s.jsx)("p",{className:"text-slate-500 text-sm italic",children:"Aún no tienes reseñas."}):(0,s.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,s.jsxs)("div",{className:"border-b border-slate-100 pb-3 last:border-0",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,s.jsx)("span",{className:"font-bold text-sm text-slate-800",children:e.autor.nombreCompleto}),(0,s.jsx)("span",{className:"text-xs text-slate-400",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,s.jsx)("div",{className:"flex text-yellow-400 mb-1",children:[...Array(e.calificacion)].map((e,a)=>(0,s.jsx)(j,{className:"w-3 h-3 fill-current"},a))}),(0,s.jsxs)("p",{className:"text-sm text-slate-600",children:['"',e.comentario,'"']})]},e.id))})]})]}):(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"No se pudo cargar tu perfil de trabajador."})})]})]})})},G=(0,f.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),X=(0,f.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),_=(0,f.default)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);function J({className:e,...a}){return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,o.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}let W=({onSuccess:e,onCancel:t})=>{let[l,r]=(0,a.useState)("dni"),[i,d]=(0,a.useState)(""),[o,n]=(0,a.useState)(""),[c,x]=(0,a.useState)(""),[m,u]=(0,a.useState)(!0),[h,p]=(0,a.useState)(!1),[f,j]=(0,a.useState)(!1),[g,v]=(0,a.useState)(""),y=async e=>{if(e.preventDefault(),j(!0),v(""),await new Promise(e=>setTimeout(e,1500)),8!==i.length||!o||!c){v("Todos los campos son obligatorios."),j(!1);return}if(Math.random()>.9){v("DNI no válido en el sistema. Por favor verifica los datos."),j(!1);return}r("background"),j(!1)},w=async()=>{j(!0),v(""),await new Promise(e=>setTimeout(e,2e3)),Math.random()>.95?(v("No se puede completar la verificación. Contacta a soporte."),u(!1),j(!1)):u(!0),r("success"),j(!1)};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 z-[70] flex items-center justify-center p-4 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Verificación de Identidad"}),(0,s.jsx)("button",{onClick:t,disabled:f,className:"p-1 hover:bg-white/10 rounded-full disabled:opacity-50",children:(0,s.jsx)(b.X,{className:"w-5 h-5"})})]}),(0,s.jsx)("p",{className:"text-indigo-100 text-sm",children:"Requerido para trabajar en ProxHogar"})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,s.jsx)("div",{className:`flex-1 h-2 rounded-full ${"dni"===l||"background"===l||"success"===l?"bg-indigo-600":"bg-slate-200"}`}),(0,s.jsx)("div",{className:`flex-1 h-2 rounded-full ${"background"===l||"success"===l?"bg-indigo-600":"bg-slate-200"}`}),(0,s.jsx)("div",{className:`flex-1 h-2 rounded-full ${"success"===l?"bg-indigo-600":"bg-slate-200"}`})]}),"dni"===l&&(0,s.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Número de DNI"}),(0,s.jsx)("input",{type:"text",maxLength:8,placeholder:"12345678",value:i,onChange:e=>{d(e.target.value.replace(/\D/g,"")),v("")},className:"w-full p-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none font-mono text-lg tracking-widest",required:!0,disabled:f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Biografía"}),(0,s.jsx)(J,{placeholder:"Cuéntanos sobre tu experiencia...",value:o,onChange:e=>n(e.target.value),className:"w-full p-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none",required:!0,disabled:f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Foto de Perfil (para DNI)"}),h?(0,s.jsxs)("div",{className:"p-3 border-2 border-emerald-200 bg-emerald-50 rounded-lg flex items-center gap-3",children:[(0,s.jsx)(X,{className:"w-6 h-6 text-emerald-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-sm text-emerald-800",children:"Foto cargada"}),(0,s.jsx)("p",{className:"text-xs text-emerald-600 truncate",children:c})]})]}):(0,s.jsxs)("button",{type:"button",onClick:()=>{j(!0),setTimeout(()=>{x(`https://i.pravatar.cc/150?u=${i||Math.random()}`),p(!0),v(""),j(!1)},800)},disabled:f,className:"w-full p-6 border-2 border-dashed border-slate-300 rounded-lg flex flex-col items-center justify-center text-slate-500 hover:bg-slate-50 hover:border-indigo-500 hover:text-indigo-600 transition-colors",children:[(0,s.jsx)(_,{className:"w-8 h-8 mb-2"}),(0,s.jsx)("span",{className:"text-sm font-bold",children:"Subir una foto"}),(0,s.jsx)("span",{className:"text-xs",children:"Esto es una simulación"})]})]}),g&&(0,s.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex gap-2",children:[(0,s.jsx)(G,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,s.jsx)("p",{className:"text-sm text-red-700",children:g})]}),(0,s.jsxs)("button",{type:"submit",disabled:f||8!==i.length||!o||!c,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[f&&"dni"===l?(0,s.jsx)(N.Loader,{className:"w-5 h-5 animate-spin"}):null,f&&"dni"===l?"Validando...":"Validar y Continuar"]})]}),"background"===l&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-bold text-slate-800 mb-2",children:"Verificación de Antecedentes"}),(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Estamos validando tu historial. Este proceso toma un momento."})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,s.jsx)(X,{className:"w-5 h-5 text-indigo-600"}),(0,s.jsx)("span",{className:"text-sm text-slate-700",children:"DNI, Biografía y Foto Verificados"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,s.jsx)(N.Loader,{className:"w-5 h-5 text-indigo-600 animate-spin"}),(0,s.jsx)("span",{className:"text-sm text-slate-700",children:"Antecedentes Penales"})]})]}),(0,s.jsxs)("button",{onClick:w,disabled:f,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-4",children:[f?(0,s.jsx)(N.Loader,{className:"w-5 h-5 animate-spin"}):null,f?"Verificando...":"Finalizar Verificación"]})]}),"success"===l&&(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center",children:(0,s.jsx)(X,{className:"w-10 h-10 text-emerald-600"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Verificación Completada"}),(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Tu identidad ha sido verificada. Ahora puedes trabajar como profesional en ProxHogar."})]}),(0,s.jsx)("button",{onClick:()=>e({biografia:o,fotoBiometricaReferenciaUrl:c,dni:i,antecedentesPenalesVerificados:m}),className:"w-full bg-emerald-600 text-white py-3 rounded-lg font-bold hover:bg-emerald-700",children:"Comenzar como Profesional"})]})]})]})})},K=(0,f.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),Y=(0,f.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var Q=e.i(92161);let ee=(0,f.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),es=()=>{let{user:e,activeRole:t,logout:r,switchToWorkerRole:i}=(0,l.useAuth)(),[d,o]=(0,a.useState)("dashboard"),[n,c]=(0,a.useState)(!1),x=async e=>{try{await i(e),c(!1)}catch(e){console.error("Failed to switch to worker role from layout.")}};return(0,s.jsxs)("div",{className:"flex min-h-screen bg-slate-50 font-sans text-slate-900",children:[(0,s.jsxs)("aside",{className:"w-64 bg-white border-r hidden md:flex flex-col justify-between fixed h-full z-20",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"h-20 flex items-center px-8 border-b",children:(0,s.jsx)("span",{className:"font-bold text-xl",children:"ProxHogar"})}),(0,s.jsxs)("div",{className:"p-4 space-y-1",children:[(0,s.jsxs)("button",{onClick:()=>o("dashboard"),className:`w-full text-left px-4 py-3 rounded-xl flex gap-3 ${"dashboard"===d?"bg-indigo-50 text-indigo-700 font-bold":"hover:bg-slate-50"}`,children:[(0,s.jsx)(K,{className:"w-5 h-5"})," Panel"]}),(0,s.jsxs)("button",{onClick:()=>o("planes"),className:`w-full text-left px-4 py-3 rounded-xl flex gap-3 ${"planes"===d?"bg-indigo-50 text-indigo-700 font-bold":"hover:bg-slate-50"}`,children:[(0,s.jsx)(E,{className:"w-5 h-5"})," Planes"]}),(0,s.jsxs)("button",{onClick:()=>o("profile"),className:`w-full text-left px-4 py-3 rounded-xl flex gap-3 ${"profile"===d?"bg-indigo-50 text-indigo-700 font-bold":"hover:bg-slate-50"}`,children:[(0,s.jsx)(R,{className:"w-5 h-5"})," Mi Perfil"]}),(0,s.jsxs)("div",{className:"mt-8 bg-slate-900 text-white p-4 rounded-xl",children:[(0,s.jsx)("p",{className:"text-xs opacity-50 mb-1",children:"Rol Actual"}),(0,s.jsx)("p",{className:"font-bold mb-3",children:t}),(0,s.jsxs)("button",{onClick:()=>{c(!0)},disabled:e?.hasChangedToWorker,className:"w-full bg-white/20 py-2 rounded text-xs flex justify-center gap-2 hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:e?.hasChangedToWorker?"El cambio de rol solo se puede realizar una vez.":"Convertirse en trabajador",children:[e?.esTrabajador?"Rol de Trabajador":"Cambiar a Trabajador"," ",(0,s.jsx)(ee,{className:"w-3 h-3"})]})]})]})]}),(0,s.jsx)("div",{className:"p-4 border-t",children:(0,s.jsxs)("button",{onClick:r,className:"flex gap-2 text-slate-500 hover:text-red-500",children:[(0,s.jsx)(Y,{className:"w-5 h-5"})," Salir"]})})]}),(0,s.jsxs)("main",{className:"flex-1 md:ml-64 p-8",children:[(0,s.jsxs)("header",{className:"flex justify-between items-center mb-8 md:hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:"ProxHogar"}),(0,s.jsx)(Q.Menu,{className:"w-6 h-6"})]}),"dashboard"===d?"CLIENTE"===t?(0,s.jsx)(O,{}):(0,s.jsx)(H,{}):"planes"===d?(0,s.jsx)(B,{}):"profile"===d?(0,s.jsx)(Z,{}):null]}),n&&(0,s.jsx)(W,{onSuccess:x,onCancel:()=>{c(!1)}})]})};function ea(){let{user:e,isLoading:r}=(0,l.useAuth)(),i=(0,t.useRouter)();return((0,a.useEffect)(()=>{r||e||i.push("/auth?mode=login")},[e,r,i]),r||!e)?(0,s.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-slate-950",children:(0,s.jsx)(N.Loader,{className:"w-8 h-8 animate-spin text-white"})}):(0,s.jsx)(es,{})}e.s(["default",()=>ea],78928)}]);