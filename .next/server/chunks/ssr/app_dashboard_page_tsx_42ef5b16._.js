module.exports=[20731,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(19817),f=a.i(53250),g=a.i(40695);let h=({variant:a="default",className:c="",...d})=>(0,b.jsx)(g.Button,{variant:{primary:"default",success:"default",danger:"destructive",ghost:"ghost",secondary:"secondary"}[a]||a,className:c,...d});var i=a.i(97895);function j({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...c})}let k=({children:a,className:c="",...d})=>(0,b.jsx)(j,{className:(0,i.cn)("bg-white rounded-xl border border-slate-100 p-5 shadow-sm hover:shadow-md transition-all duration-300",c),...d,children:a});var l=a.i(11011);let m=(0,a.i(187).cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function n({className:a,variant:c,asChild:d=!1,...e}){let f=d?l.Slot:"span";return(0,b.jsx)(f,{"data-slot":"badge",className:(0,i.cn)(m({variant:c}),a),...e})}let o=({status:a})=>(0,b.jsx)(n,{variant:"outline",className:{PENDIENTE:"bg-orange-100 text-orange-700 border-orange-200",OFERTANDO:"bg-blue-100 text-blue-700 border-blue-200",EN_PROCESO:"bg-purple-100 text-purple-700 border-purple-200",FINALIZADA:"bg-emerald-100 text-emerald-700 border-emerald-200",CANCELADA:"bg-gray-100 text-gray-500 border-gray-200"}[a]||"bg-gray-100",children:a});var p=a.i(33508),q=a.i(3314),r=a.i(70106);let s=(0,r.default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),t=(0,r.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var u=a.i(28193);let v=({worker:a,onClose:d,user:e})=>{let[g,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{a?.usuario?.id&&(0,f.apiCall)({endpoint:`/resenas/usuario/${a.usuario.id}`,method:"GET"}).then(i).finally(()=>k(!1))},[a]),(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col shadow-2xl",children:[(0,b.jsxs)("div",{className:"bg-slate-900 text-white p-6 relative",children:[(0,b.jsx)("button",{onClick:d,className:"absolute top-4 right-4 p-1 hover:bg-white/10 rounded-full",children:(0,b.jsx)(p.X,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-indigo-500 rounded-full flex items-center justify-center text-2xl font-bold border-4 border-white/10",children:a.usuario.nombreCompleto.charAt(0)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[a.usuario.nombreCompleto,a.verificado&&(0,b.jsx)(q.Shield,{className:"w-4 h-4 text-emerald-400 fill-current"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-yellow-400 text-sm font-medium mt-1",children:[(0,b.jsx)(s,{className:"w-4 h-4 fill-current"})," ",a.calificacionPromedio]})]})]})]}),(0,b.jsxs)("div",{className:"p-6 overflow-y-auto",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-2",children:"Biografía"}),(0,b.jsx)("p",{className:"text-slate-700 bg-slate-50 p-4 rounded-xl text-sm leading-relaxed",children:a.biografia||"Sin biografía disponible."})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,b.jsx)(t,{className:"w-4 h-4"})," Comentarios (",g.length,")"]}),j?(0,b.jsx)("div",{className:"text-center py-4",children:(0,b.jsx)(u.Loader,{className:"w-6 h-6 animate-spin mx-auto text-indigo-600"})}):0===g.length?(0,b.jsx)("p",{className:"text-slate-500 text-sm italic",children:"Sin reseñas."}):(0,b.jsx)("div",{className:"space-y-3",children:g.map(a=>(0,b.jsxs)("div",{className:"border-b border-slate-100 pb-3 last:border-0",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,b.jsx)("span",{className:"font-bold text-sm text-slate-800",children:a.autor.nombreCompleto}),(0,b.jsx)("span",{className:"text-xs text-slate-400",children:new Date(a.createdAt).toLocaleDateString()})]}),(0,b.jsx)("div",{className:"flex text-yellow-400 w-3 h-3 gap-0.5 mb-1",children:[...Array(a.calificacion)].map((a,c)=>(0,b.jsx)(s,{className:"w-3 h-3 fill-current"},c))}),(0,b.jsxs)("p",{className:"text-sm text-slate-600",children:['"',a.comentario,'"']})]},a.id))})]})]}),(0,b.jsx)("div",{className:"p-4 border-t bg-slate-50 text-center",children:(0,b.jsx)(h,{variant:"secondary",onClick:d,className:"w-full",children:"Cerrar Perfil"})})]})})},w=({reqId:a,onClose:d,user:e,onAccept:g})=>{let[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(null);(0,c.useEffect)(()=>{(0,f.apiCall)({endpoint:`/ofertas/solicitud/${a}`,method:"GET"}).then(j).catch(console.error)},[a]);let m=async a=>{confirm("¿Aceptar esta oferta?")&&(await (0,f.apiCall)({endpoint:`/ofertas/${a}/aceptar`,method:"PUT"}),alert("Oferta Aceptada"),g(),d())};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg p-6 max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,b.jsx)("h3",{className:"font-bold",children:"Ofertas Recibidas"}),(0,b.jsx)("button",{onClick:d,children:(0,b.jsx)(p.X,{})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[i.map(a=>(0,b.jsxs)("div",{className:"border p-4 rounded-xl hover:border-indigo-200 transition-all bg-slate-50",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>{console.log("Selected worker data:",a.trabajador),l(a.trabajador)},children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-indigo-600 text-white flex items-center justify-center font-bold",children:a.trabajador.usuario.nombreCompleto.charAt(0)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-bold text-sm text-slate-800 group-hover:text-indigo-600 transition-colors flex items-center gap-1",children:[a.trabajador.usuario.nombreCompleto,a.trabajador.verificado&&(0,b.jsx)(q.Shield,{className:"w-3 h-3 text-emerald-500 fill-current"})]}),(0,b.jsxs)("div",{className:"flex text-xs text-yellow-500",children:[(0,b.jsx)(s,{className:"w-3 h-3 fill-current"})," ",a.trabajador.calificacionPromedio]})]})]}),(0,b.jsxs)("span",{className:"font-bold text-lg text-emerald-600",children:["S/. ",a.montoOfrecido]})]}),(0,b.jsxs)("p",{className:"text-sm text-slate-600 italic mb-3",children:['"',a.comentario,'"']}),(0,b.jsx)(h,{onClick:()=>m(a.id),variant:"success",className:"w-full text-xs py-2",children:"Aceptar y Contratar"})]},a.id)),0===i.length&&(0,b.jsx)("p",{className:"text-center text-slate-400 py-4",children:"Aún no hay ofertas."})]})]})}),k&&(0,b.jsx)(v,{worker:k,onClose:()=>l(null),user:e})]})},x=(0,r.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),y=async a=>new Promise(b=>setTimeout(()=>b(`(IA): Descripci\xf3n mejorada para: "${a}"`),1e3)),z=({userId:a,categories:d,editingId:e,initialForm:g,onSuccess:i,onCancel:j})=>{let[k,l]=(0,c.useState)(g||{catId:1,desc:"",price:"",addr:"",lat:-8.11,lng:-79.03}),[m,n]=(0,c.useState)(!1),[o,q]=(0,c.useState)(!1),r=async()=>{if(!k.desc)return;n(!0);let a=`Mejora esta descripci\xf3n corta para una solicitud de trabajo en casa (s\xe9 conciso, profesional y claro): "${k.desc}"`,b=await y(a);b&&l({...k,desc:b}),n(!1)},s=async b=>{b.preventDefault(),q(!0);try{let b={categoriaId:k.catId,descripcion:k.desc,precioSugerido:Number.parseFloat(k.price),direccion:k.addr,referencia:"Web",latitud:k.lat,longitud:k.lng};e?(await (0,f.apiCall)({endpoint:`/solicitudes/${e}?clienteId=${a}`,method:"PUT",body:b}),alert("Solicitud Actualizada")):(await (0,f.apiCall)({endpoint:`/solicitudes?clienteId=${a}`,method:"POST",body:b}),alert("Solicitud Creada")),i()}catch(a){alert("Error al crear la solicitud"),console.error(a)}finally{q(!1)}};return(0,b.jsxs)("div",{className:"bg-white rounded-3xl border border-slate-100 p-8 shadow-sm max-w-3xl mx-auto animate-in fade-in zoom-in duration-300",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:e?"Editar Solicitud":"Crear Solicitud"}),(0,b.jsx)("button",{onClick:j,className:"p-2 hover:bg-slate-50 rounded-full text-slate-400",children:(0,b.jsx)(p.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("form",{onSubmit:s,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-bold text-slate-700 block mb-3",children:"Selecciona Categoría"}),(0,b.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2",children:d.map(a=>(0,b.jsxs)("div",{onClick:()=>l({...k,catId:a.id}),className:`cursor-pointer min-w-[120px] p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${k.catId===a.id?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-slate-100 hover:border-slate-300"}`,children:[(0,b.jsx)("img",{src:a.urlIcono||"/placeholder.svg",className:"w-8 h-8 opacity-75",onError:a=>a.currentTarget.src="https://cdn-icons-png.flaticon.com/512/1087/1087815.png",alt:a.nombre}),(0,b.jsx)("span",{className:"text-xs font-bold",children:a.nombre})]},a.id))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-end mb-2",children:[(0,b.jsx)("label",{className:"text-sm font-bold text-slate-700",children:"Descripción"}),(0,b.jsxs)("button",{type:"button",onClick:r,disabled:m,className:"text-xs text-indigo-600 font-bold flex items-center gap-1 hover:text-indigo-700 disabled:opacity-50",children:[(0,b.jsx)(x,{className:"w-3 h-3"})," ",m?"Generando...":"Mejorar con IA"]})]}),(0,b.jsx)("textarea",{required:!0,className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none resize-none transition-all",rows:3,onChange:a=>l({...k,desc:a.target.value}),value:k.desc,placeholder:"Describe el servicio que necesitas..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-bold text-slate-700 block mb-2",children:"Precio (S/.)"}),(0,b.jsx)("input",{required:!0,type:"number",className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",onChange:a=>l({...k,price:a.target.value}),value:k.price,placeholder:"0.00"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-bold text-slate-700 block mb-2",children:"Dirección"}),(0,b.jsx)("input",{required:!0,type:"text",className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",onChange:a=>l({...k,addr:a.target.value}),value:k.addr,placeholder:"Tu dirección..."})]})]}),(0,b.jsxs)("div",{className:"pt-4 flex justify-end gap-3",children:[(0,b.jsx)(h,{variant:"ghost",onClick:j,children:"Cancelar"}),(0,b.jsxs)(h,{type:"submit",disabled:o,children:[o?(0,b.jsx)(u.Loader,{className:"w-4 h-4 animate-spin"}):null,e?"Guardar Cambios":"Publicar Ahora"]})]})]})]})},A=(0,r.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),B=(0,r.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),C=(0,r.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),D=(0,r.default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),E=(0,r.default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),F=(0,r.default)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),G=({requestId:a,amount:d,onClose:e,onPaymentSuccess:f})=>{let[g,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!1),l=[{id:"card",name:"Tarjeta de Crédito/Débito",icon:D,description:"Visa, Mastercard, American Express"},{id:"yape",name:"Yape",icon:E,description:"Pago por teléfono"},{id:"transfer",name:"Transferencia Bancaria",icon:F,description:"Transferencia a cuenta bancaria"}],m=async()=>{g?(k(!0),setTimeout(()=>{alert(`Pago de S/. ${d} procesado con ${g}`),f(),e()},1500)):alert("Selecciona un método de pago")};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl animate-in slide-in-from-bottom-4",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:"Selecciona Método de Pago"}),(0,b.jsx)("button",{onClick:e,className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,b.jsx)(p.X,{className:"w-5 h-5 text-slate-400"})})]}),(0,b.jsx)("div",{className:"p-6 space-y-3",children:l.map(a=>{let c=a.icon;return(0,b.jsxs)("button",{onClick:()=>i(a.id),className:`w-full p-4 rounded-xl border-2 transition-all flex items-start gap-3 text-left ${g===a.id?"border-indigo-600 bg-indigo-50":"border-slate-200 hover:border-indigo-300"}`,children:[(0,b.jsx)(c,{className:"w-5 h-5 text-indigo-600 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-slate-800",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.description})]})]},a.id)})}),(0,b.jsxs)("div",{className:"p-6 bg-slate-50 border-t border-slate-100 rounded-b-2xl",children:[(0,b.jsxs)("div",{className:"mb-4 p-4 bg-white rounded-lg border border-slate-200",children:[(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Monto a pagar"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:["S/. ",d]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h,{variant:"ghost",onClick:e,className:"flex-1",children:"Cancelar"}),(0,b.jsx)(h,{onClick:m,disabled:j,className:"flex-1",children:j?"Procesando...":"Confirmar Pago"})]})]})]})})},H=({workerUsuarioId:a,workerName:d,requestId:e,onClose:f,onSubmit:g})=>{let[i,j]=(0,c.useState)(0),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(!1),o=async()=>{0===i?alert("Selecciona una calificación"):(n(!0),setTimeout(()=>{g(i,k),n(!1),f()},800))};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl animate-in slide-in-from-bottom-4",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:"Calificar Trabajo"}),(0,b.jsxs)("p",{className:"text-sm text-slate-500",children:["Servicio de ",d]})]}),(0,b.jsx)("button",{onClick:f,className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,b.jsx)(p.X,{className:"w-5 h-5 text-slate-400"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-3",children:"Calificación"}),(0,b.jsx)("div",{className:"flex gap-2 justify-center",children:[1,2,3,4,5].map(a=>(0,b.jsx)("button",{onClick:()=>j(a),className:"transition-transform hover:scale-110",children:(0,b.jsx)(s,{className:`w-8 h-8 ${a<=i?"fill-yellow-400 text-yellow-400":"text-slate-300"}`})},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Comentario"}),(0,b.jsx)("textarea",{value:k,onChange:a=>l(a.target.value),placeholder:"Cuéntanos sobre tu experiencia con este trabajador...",className:"w-full p-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none",rows:4}),(0,b.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:[k.length,"/500"]})]})]}),(0,b.jsxs)("div",{className:"p-6 bg-slate-50 border-t border-slate-100 rounded-b-2xl flex gap-2",children:[(0,b.jsx)(h,{variant:"ghost",onClick:f,className:"flex-1",children:"Cancelar"}),(0,b.jsx)(h,{onClick:o,disabled:m||0===i,className:"flex-1",children:m?"Enviando...":"Enviar Calificación"})]})]})})},I=()=>{let{user:a,logout:d}=(0,e.useAuth)(),[g,i]=(0,c.useState)("list"),[j,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,x]=(0,c.useState)(null),[y,D]=(0,c.useState)(null);(0,c.useEffect)(()=>{if(!a||!a.usuarioId){console.warn("Usuario sin ID detectado. Cerrando sesión para limpiar cache."),d();return}E()},[a]);let E=()=>{a?.usuarioId&&((0,f.apiCall)({endpoint:"/categorias"}).then(l),(0,f.apiCall)({endpoint:`/solicitudes/mis-pedidos?clienteId=${a.usuarioId}`,method:"GET"}).then(n))},F=async b=>{if(confirm("¿Estás seguro de eliminar esta solicitud?")&&a?.usuarioId)try{await (0,f.apiCall)({endpoint:`/solicitudes/${b}?clienteId=${a.usuarioId}`,method:"DELETE"}),E()}catch(a){alert("Error al eliminar")}},I=async b=>{if(a)try{await (0,f.apiCall)({endpoint:`/solicitudes/${b}/finalizar?clienteId=${a.usuarioId}`,method:"PUT"});let c=m.find(a=>a.id===b);c&&c.trabajadorElegido&&c.trabajadorElegido.usuario?D({requestId:b,workerUsuarioId:c.trabajadorElegido.usuario.id,workerName:c.trabajadorElegido.usuario.nombreCompleto||"Trabajador"}):E()}catch(a){console.error("Error al finalizar la solicitud:",a),alert("Hubo un error al finalizar la solicitud. Por favor, recarga la página.")}},J=async(a,b)=>{if(y)try{await (0,f.apiCall)({endpoint:"/resenas",method:"POST",body:{solicitudId:y.requestId,usuarioCalificadoId:y.workerUsuarioId,estrellas:a,comentario:b}}),D(null),E()}catch(a){alert("Error al enviar la calificación")}};return(0,b.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4",children:[(0,b.jsxs)("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-sm flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold text-slate-800",children:["Hola, ",a?.nombreCompleto?.split(" ")[0]||"Usuario"]}),(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"Gestiona tus servicios."})]}),(0,b.jsx)(h,{onClick:()=>{s(null),u(null),i("create")},children:"+ Nueva Solicitud"})]}),(0,b.jsxs)("div",{className:"flex gap-6 border-b border-slate-200",children:[(0,b.jsx)("button",{onClick:()=>i("list"),className:`pb-3 text-sm font-bold border-b-2 transition-colors ${"list"===g?"border-indigo-600 text-indigo-600":"border-transparent text-slate-500"}`,children:"Activos"}),(0,b.jsx)("button",{onClick:()=>i("history"),className:`pb-3 text-sm font-bold border-b-2 transition-colors ${"history"===g?"border-indigo-600 text-indigo-600":"border-transparent text-slate-500"}`,children:"Historial Completo"})]}),"create"===g&&a?(0,b.jsx)(z,{userId:a.usuarioId,categories:j,editingId:r,initialForm:t,onSuccess:()=>{i("list"),s(null),u(null),E()},onCancel:()=>{i("list"),s(null),u(null)}}):"create"!==g||a?(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[("list"===g?m.filter(a=>"FINALIZADA"!==a.estado&&"CANCELADA"!==a.estado):m.filter(a=>"FINALIZADA"===a.estado||"CANCELADA"===a.estado)).map(a=>(0,b.jsxs)(k,{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)(o,{status:a.estado}),(0,b.jsxs)("span",{className:"text-xs text-slate-400",children:["#",a.id]})]}),(0,b.jsx)("h3",{className:"font-bold text-slate-800",children:a.descripcion}),(0,b.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:a.direccion}),(0,b.jsxs)("div",{className:"flex gap-2 text-xs text-slate-400 mb-4",children:[(0,b.jsx)(C,{className:"w-3 h-3"})," ",(0,b.jsx)("span",{children:a.createdAt||"Hoy"})]}),(0,b.jsxs)("div",{className:"pt-4 border-t flex justify-between items-center",children:[(0,b.jsxs)("span",{className:"font-bold text-indigo-600",children:["S/. ",a.precioSugerido]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["PENDIENTE"===a.estado&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>{s(a.id),u({catId:a.categoriaId||1,desc:a.descripcion,price:a.precioSugerido,addr:a.direccion,lat:a.latitud||-8.11,lng:a.longitud||-79.03}),i("create")},className:"p-2 hover:bg-slate-100 rounded-full text-slate-500",children:(0,b.jsx)(A,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>F(a.id),className:"p-2 hover:bg-rose-50 rounded-full text-rose-500",children:(0,b.jsx)(B,{className:"w-4 h-4"})})]}),"OFERTANDO"===a.estado&&(0,b.jsx)(h,{variant:"secondary",className:"text-xs h-8",onClick:()=>q(a.id),children:"Ver Ofertas"}),"FINALIZADO_POR_TRABAJADOR"===a.estado&&(0,b.jsx)(h,{variant:"success",className:"text-xs h-8",onClick:()=>x(a.id),children:"Pagar y Finalizar"})]})]})]},a.id)),m.length>0&&0===("list"===g?m.filter(a=>"FINALIZADA"!==a.estado&&"CANCELADA"!==a.estado):m.filter(a=>"FINALIZADA"===a.estado||"CANCELADA"===a.estado)).length&&(0,b.jsx)("div",{className:"col-span-2 text-center py-10 border-2 border-dashed border-slate-200 rounded-xl",children:(0,b.jsx)("p",{className:"text-slate-400",children:"No hay solicitudes en esta sección."})})]}):(0,b.jsx)("div",{className:"col-span-2 text-center py-10 border-2 border-dashed border-slate-200 rounded-xl",children:(0,b.jsx)("p",{className:"text-slate-400",children:"Inicia sesión para crear una solicitud."})}),p&&a&&(0,b.jsx)(w,{reqId:p,onClose:()=>q(null),user:a,onAccept:E}),v&&(0,b.jsx)(G,{requestId:v,amount:m.find(a=>a.id===v)?.precioSugerido||0,onClose:()=>x(null),onPaymentSuccess:()=>I(v)}),y&&(0,b.jsx)(H,{requestId:y.requestId,workerUsuarioId:y.workerUsuarioId,workerName:y.workerName,onClose:()=>D(null),onSubmit:J})]})},J=({solicitudId:a,onClose:d,onSubmit:e})=>{let[f,g]=(0,c.useState)(""),[i,j]=(0,c.useState)("");return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h3",{className:"font-bold text-lg",children:"Enviar Mi Oferta"}),(0,b.jsx)("button",{onClick:d,className:"text-slate-500 hover:text-slate-800",children:(0,b.jsx)(p.X,{size:24})})]}),(0,b.jsxs)("form",{onSubmit:a=>{(a.preventDefault(),f)?e({montoOfrecido:parseFloat(f),comentario:i}):alert("Por favor, ingresa un monto.")},className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"montoOfrecido",className:"block text-sm font-medium text-slate-700 mb-1",children:"¿Cuánto quieres cobrar? (S/.)"}),(0,b.jsx)("input",{type:"number",id:"montoOfrecido",value:f,onChange:a=>g(a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Ej: 80.00",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"comentario",className:"block text-sm font-medium text-slate-700 mb-1",children:"Comentario (Opcional)"}),(0,b.jsx)("textarea",{id:"comentario",value:i,onChange:a=>j(a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Ej: Tengo experiencia y herramientas. Puedo empezar ahora mismo.",rows:3})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,b.jsx)(h,{type:"button",variant:"ghost",onClick:d,children:"Cancelar"}),(0,b.jsx)(h,{type:"submit",variant:"success",children:"Enviar Oferta"})]})]})]})})},K=(0,r.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),L=(0,r.default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),M=({solicitudId:a,onClose:d,onSuccess:e})=>{let[g,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),l=async()=>{i(!0),k(null);try{let b=await new Promise(a=>setTimeout(()=>a({lat:-8.11,lng:-79.03}),500)),c=await (0,f.apiCall)({endpoint:"/biometria/verificar",method:"POST",body:{solicitudId:a,latitudActual:b.lat,longitudActual:b.lng,fotoSelfieUrl:"https://this-person-does-not-exist.com/img/avatar-1126a908256a7e1329a3512b963155d0.jpg"}});if(c.exito)alert("Verificación biométrica exitosa."),e(a),d();else throw Error(c.mensaje||"La verificación biométrica ha fallado.")}catch(a){k(a.message||"Ocurrió un error inesperado durante la verificación.")}finally{i(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl animate-in slide-in-from-bottom-4",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-slate-800",children:"Verificación de Identidad"}),(0,b.jsx)("button",{onClick:d,className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,b.jsx)(p.X,{className:"w-5 h-5 text-slate-400"})})]}),(0,b.jsxs)("div",{className:"p-6 text-center",children:[(0,b.jsx)("p",{className:"text-slate-600 mb-6",children:"Para garantizar la seguridad, por favor completa una verificación rápida antes de iniciar el trabajo."}),(0,b.jsxs)("div",{className:"flex justify-center gap-8 text-slate-500 mb-8",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)(K,{className:"w-8 h-8"}),(0,b.jsx)("span",{className:"text-xs font-medium",children:"Selfie Rápida"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)(L,{className:"w-8 h-8"}),(0,b.jsx)("span",{className:"text-xs font-medium",children:"Ubicación GPS"})]})]}),j&&(0,b.jsx)("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-lg mb-4",children:j}),(0,b.jsx)(h,{onClick:l,disabled:g,className:"w-full",children:g?(0,b.jsx)(u.Loader,{className:"w-5 h-5 animate-spin"}):"Iniciar Verificación"})]})]})})},N=(0,r.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),O=(0,r.default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),P=(0,r.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Q=({jobs:a,onJobAction:c,isHistory:d=!1})=>0===a.length?(0,b.jsx)("div",{className:"text-center py-10 border-2 border-dashed border-slate-200 rounded-xl",children:(0,b.jsx)("p",{className:"text-slate-400",children:d?"No tienes trabajos en tu historial.":"No tienes trabajos aceptados por el momento."})}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(a=>(0,b.jsxs)(k,{className:"bg-white",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsxs)("span",{className:"text-xs bg-slate-100 px-2 py-1 rounded font-bold",children:["#",a.id]}),(0,b.jsxs)("span",{className:"font-bold text-emerald-600",children:["S/. ",a.precioSugerido]})]}),(0,b.jsx)("h4",{className:"font-bold text-slate-800 mb-2",children:a.descripcion}),(0,b.jsxs)("div",{className:"text-sm text-slate-500 space-y-2 mt-4 pt-4 border-t",children:[(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(L,{className:"w-4 h-4 text-slate-400"})," ",a.direccion]}),(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(N,{className:"w-4 h-4 text-slate-400"})," ",a.cliente?.nombreCompleto||"Cliente Anónimo"]}),(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(O,{className:"w-4 h-4 text-slate-400"})," ",a.cliente?.telefono||"No disponible"]})]}),(0,b.jsxs)("div",{className:"mt-4 pt-4 border-t",children:["ACEPTADO"===a.estado&&(0,b.jsx)(h,{className:"w-full",onClick:()=>c("start",a.id),children:"Iniciar Trabajo"}),"EN_PROCESO"===a.estado&&(0,b.jsx)(h,{className:"w-full",variant:"success",onClick:()=>c("finish",a.id),children:"Finalizar Trabajo"}),("FINALIZADA"===a.estado||"FINALIZADO_POR_TRABAJADOR"===a.estado)&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-emerald-600 font-bold py-2",children:[(0,b.jsx)(P,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Trabajo Completado"})]}),"CANCELADA"===a.estado&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-rose-600 font-bold py-2",children:[(0,b.jsx)(p.X,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Cancelado"})]})]})]},a.id))}),R=()=>{let{user:a}=(0,e.useAuth)(),[d,g]=(0,c.useState)([]),[i,j]=(0,c.useState)([]),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)("disponibles"),[p,q]=(0,c.useState)(!1),[r,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null);(0,c.useEffect)(()=>{a?.usuarioId&&w()},[a]);let w=()=>{a?.usuarioId&&Promise.all([(0,f.apiCall)({endpoint:"/solicitudes/disponibles"}),(0,f.apiCall)({endpoint:`/solicitudes/mis-trabajos?usuarioId=${a.usuarioId}`}),(0,f.apiCall)({endpoint:`/trabajadores/usuario/${a.usuarioId}`})]).then(([a,b,c])=>{g(a),j(b),m(c)}).catch(a=>console.error("Error fetching worker data:",a))},x=()=>{t(null),q(!1)},y=async b=>{if(r&&a)try{await (0,f.apiCall)({endpoint:`/ofertas?trabajadorUsuarioId=${a.usuarioId}`,method:"POST",body:{solicitudId:r,...b}}),alert("¡Oferta enviada con éxito!"),x(),w()}catch(a){console.error("Error al enviar la oferta:",a),alert("Hubo un error al enviar tu oferta.")}},z=async b=>{if(a)try{await (0,f.apiCall)({endpoint:`/solicitudes/${b}/iniciar?trabajadorUsuarioId=${a.usuarioId}`,method:"PUT"}),alert("Trabajo iniciado. ¡Buena suerte!"),w()}catch(a){console.error("Error al iniciar trabajo:",a),alert("No se pudo iniciar el trabajo.")}},A=async b=>{if(a)try{await (0,f.apiCall)({endpoint:`/solicitudes/${b}/trabajador-finalizar?trabajadorUsuarioId=${a.usuarioId}`,method:"PUT"}),alert("¡Trabajo marcado como finalizado! El cliente será notificado para realizar el pago."),w()}catch(a){console.error("Error al finalizar trabajo:",a),alert("No se pudo finalizar el trabajo.")}},B=i.filter(a=>"ACEPTADO"===a.estado||"EN_PROCESO"===a.estado),C=i.filter(a=>"FINALIZADO_POR_TRABAJADOR"===a.estado||"FINALIZADA"===a.estado||"CANCELADA"===a.estado);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto p-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"bg-slate-900 text-white p-6 rounded-2xl",children:[(0,b.jsx)("p",{className:"text-slate-400 text-sm",children:"Ganancias"}),(0,b.jsx)("h3",{className:"text-3xl font-bold",children:"S/. 450"})]}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-2xl border shadow-sm",children:[(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"Calificación"}),(0,b.jsxs)("h3",{className:"text-3xl font-bold text-slate-800 flex items-center gap-2",children:[(0,b.jsx)(s,{className:"w-7 h-7 text-yellow-400"}),l?.calificacionPromedio?.toFixed(1)||"N/A"]})]}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-2xl border shadow-sm",children:[(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"Trabajos Completados"}),(0,b.jsx)("h3",{className:"text-3xl font-bold text-slate-800",children:l?.trabajosCompletados||0})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 border-b",children:[(0,b.jsx)("button",{onClick:()=>o("disponibles"),className:`px-4 py-2 font-medium transition-colors ${"disponibles"===n?"text-indigo-600 border-b-2 border-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:"Disponibles"}),(0,b.jsxs)("button",{onClick:()=>o("aceptados"),className:`px-4 py-2 font-medium transition-colors relative ${"aceptados"===n?"text-indigo-600 border-b-2 border-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:["Mis Trabajos",B.length>0&&(0,b.jsx)("span",{className:"ml-2 bg-indigo-600 text-white text-xs rounded-full px-2 py-0.5",children:B.length})]}),(0,b.jsx)("button",{onClick:()=>o("historial"),className:`px-4 py-2 font-medium transition-colors ${"historial"===n?"text-indigo-600 border-b-2 border-indigo-600":"text-slate-500 hover:text-slate-700"}`,children:"Historial"})]}),"disponibles"===n&&(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[d.map(a=>(0,b.jsxs)(k,{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsxs)("span",{className:"text-xs bg-slate-100 px-2 py-1 rounded font-bold",children:["#",a.id]}),(0,b.jsxs)("span",{className:"font-bold text-emerald-600",children:["S/. ",a.precioSugerido]})]}),(0,b.jsx)("h4",{className:"font-bold text-slate-800 mb-2",children:a.descripcion}),(0,b.jsxs)("p",{className:"text-sm text-slate-500 mb-4 flex items-center gap-1",children:[(0,b.jsx)(L,{className:"w-3 h-3"})," ",a.direccion]}),(0,b.jsx)(h,{className:"w-full",onClick:()=>{t(a.id),q(!0)},children:"Postularme"})]},a.id)),0===d.length&&(0,b.jsx)("p",{className:"col-span-full text-center py-8 text-slate-400",children:"No hay trabajos disponibles."})]}),"aceptados"===n&&(0,b.jsx)(Q,{jobs:B,onJobAction:(a,b)=>{switch(a){case"start":v(b);break;case"finish":A(b)}}}),"historial"===n&&(0,b.jsx)(Q,{jobs:C,onJobAction:()=>{},isHistory:!0})]}),p&&r&&(0,b.jsx)(J,{solicitudId:r,onClose:x,onSubmit:y}),u&&(0,b.jsx)(M,{solicitudId:u,onClose:()=>v(null),onSuccess:z})]})},S=()=>{let{user:a,activeRole:d}=(0,e.useAuth)(),[g,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(null);(0,c.useEffect)(()=>{d&&(0,f.apiCall)({endpoint:`/suscripciones/planes?rol=${d}`}).then(i)},[d]);let l=async b=>{let c=b||j?.id;if(!c||!a)return void alert("Error: No se pudo determinar el plan o el usuario.");try{await (0,f.apiCall)({endpoint:`/suscripciones/suscribir?usuarioId=${a.usuarioId}`,method:"POST",body:{planId:c,meses:1}}),alert("¡Suscripción activada con éxito!"),k(null)}catch(a){console.error("Error al suscribirse:",a),alert("Hubo un error al procesar tu suscripción.")}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"max-w-5xl mx-auto p-4",children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold text-center mb-8",children:["Planes para ","TRABAJADOR"===d?"Profesionales":"Clientes"]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:g.map(a=>(0,b.jsxs)("div",{className:`bg-white p-8 rounded-3xl border transition-all ${a.recomendado?"border-indigo-500 shadow-xl scale-105":"border-slate-200"}`,children:[(0,b.jsx)("h3",{className:"font-bold text-xl text-slate-800",children:a.nombre}),(0,b.jsxs)("div",{className:"my-4 flex items-baseline gap-1",children:[(0,b.jsxs)("span",{className:"text-4xl font-black text-slate-900",children:["S/.",a.precio]}),(0,b.jsx)("span",{className:"text-sm text-slate-500",children:a.periodo})]}),(0,b.jsx)("ul",{className:"space-y-2 mb-8",children:a.features.split("|").map((a,c)=>(0,b.jsxs)("li",{className:"flex gap-2 text-sm text-slate-600",children:[(0,b.jsx)(P,{className:"w-4 h-4 text-emerald-500"})," ",a]},c))}),(0,b.jsx)(h,{className:"w-full",variant:a.recomendado?"primary":"secondary",onClick:()=>{0===a.precio?l(a.id):k(a)},children:0===a.precio?"Activar Gratis":"Seleccionar"})]},a.id))})]}),j&&(0,b.jsx)(G,{requestId:j.id,amount:j.precio,onClose:()=>k(null),onPaymentSuccess:()=>l()})]})},T=()=>{let{user:a,activeRole:d}=(0,e.useAuth)(),[g,i]=(0,c.useState)(null),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{a?.usuarioId&&a.esTrabajador?(m(!0),Promise.all([(0,f.apiCall)({endpoint:`/trabajadores/usuario/${a.usuarioId}`}),(0,f.apiCall)({endpoint:`/resenas/usuario/${a.usuarioId}`})]).then(([a,b])=>{i(a),k(b)}).catch(a=>console.error("Error fetching worker profile:",a)).finally(()=>m(!1))):m(!1)},[a]),(0,b.jsx)("div",{className:"max-w-4xl mx-auto p-4 animate-in fade-in",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,b.jsx)("div",{className:"h-32 bg-gradient-to-r from-indigo-500 to-purple-600"}),(0,b.jsxs)("div",{className:"px-8 pb-8",children:[(0,b.jsxs)("div",{className:"relative flex justify-between items-end -mt-12 mb-6",children:[(0,b.jsx)("div",{className:"w-24 h-24 bg-white p-1 rounded-full shadow-lg",children:(0,b.jsx)("div",{className:"w-full h-full bg-slate-200 rounded-full flex items-center justify-center text-3xl font-bold text-slate-500",children:a?.nombreCompleto?.charAt(0)})}),(0,b.jsx)(h,{variant:"secondary",children:"Editar Perfil"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:a?.nombreCompleto}),(0,b.jsx)("p",{className:"text-slate-500",children:a?.email}),(0,b.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,b.jsx)("span",{className:"px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded font-bold",children:d}),a?.esTrabajador&&g?.verificado&&(0,b.jsxs)("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded font-bold flex items-center gap-1",children:[(0,b.jsx)(q.Shield,{className:"w-3 h-3"})," Verificado"]})]})]}),a?.esTrabajador&&(0,b.jsx)("div",{className:"mt-8 pt-8 border-t border-slate-100",children:l?(0,b.jsx)("div",{className:"text-center py-4",children:(0,b.jsx)(u.Loader,{className:"w-6 h-6 animate-spin mx-auto text-indigo-600"})}):g?(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Estadísticas de Trabajador"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Calificación"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-indigo-600 flex items-center gap-2",children:[(0,b.jsx)(s,{className:"w-5 h-5 text-yellow-400"}),g.calificacionPromedio?.toFixed(1)||"N/A"]})]}),(0,b.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Trabajos Completados"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:g.trabajosCompletados||0})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-bold text-lg mb-4",children:"Biografía"}),(0,b.jsx)("p",{className:"text-slate-700 bg-slate-50 p-4 rounded-xl text-sm leading-relaxed",children:g.biografia||"No has establecido una biografía todavía."})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[(0,b.jsx)(t,{className:"w-5 h-5"})," Comentarios Recibidos (",j.length,")"]}),0===j.length?(0,b.jsx)("p",{className:"text-slate-500 text-sm italic",children:"Aún no tienes reseñas."}):(0,b.jsx)("div",{className:"space-y-4",children:j.map(a=>(0,b.jsxs)("div",{className:"border-b border-slate-100 pb-3 last:border-0",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,b.jsx)("span",{className:"font-bold text-sm text-slate-800",children:a.autor.nombreCompleto}),(0,b.jsx)("span",{className:"text-xs text-slate-400",children:new Date(a.createdAt).toLocaleDateString()})]}),(0,b.jsx)("div",{className:"flex text-yellow-400 mb-1",children:[...Array(a.calificacion)].map((a,c)=>(0,b.jsx)(s,{className:"w-3 h-3 fill-current"},c))}),(0,b.jsxs)("p",{className:"text-sm text-slate-600",children:['"',a.comentario,'"']})]},a.id))})]})]}):(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"No se pudo cargar tu perfil de trabajador."})})]})]})})},U=(0,r.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),V=(0,r.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),W=(0,r.default)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);function X({className:a,...c}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,i.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...c})}let Y=({onSuccess:a,onCancel:d})=>{let[e,f]=(0,c.useState)("dni"),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(!0),[o,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,v]=(0,c.useState)(""),w=async a=>{if(a.preventDefault(),s(!0),v(""),await new Promise(a=>setTimeout(a,1500)),8!==g.length||!i||!k){v("Todos los campos son obligatorios."),s(!1);return}if(Math.random()>.9){v("DNI no válido en el sistema. Por favor verifica los datos."),s(!1);return}f("background"),s(!1)},x=async()=>{s(!0),v(""),await new Promise(a=>setTimeout(a,2e3)),Math.random()>.95?(v("No se puede completar la verificación. Contacta a soporte."),n(!1),s(!1)):n(!0),f("success"),s(!1)};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 z-[70] flex items-center justify-center p-4 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white p-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Verificación de Identidad"}),(0,b.jsx)("button",{onClick:d,disabled:r,className:"p-1 hover:bg-white/10 rounded-full disabled:opacity-50",children:(0,b.jsx)(p.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("p",{className:"text-indigo-100 text-sm",children:"Requerido para trabajar en ProxHogar"})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,b.jsx)("div",{className:`flex-1 h-2 rounded-full ${"dni"===e||"background"===e||"success"===e?"bg-indigo-600":"bg-slate-200"}`}),(0,b.jsx)("div",{className:`flex-1 h-2 rounded-full ${"background"===e||"success"===e?"bg-indigo-600":"bg-slate-200"}`}),(0,b.jsx)("div",{className:`flex-1 h-2 rounded-full ${"success"===e?"bg-indigo-600":"bg-slate-200"}`})]}),"dni"===e&&(0,b.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Número de DNI"}),(0,b.jsx)("input",{type:"text",maxLength:8,placeholder:"12345678",value:g,onChange:a=>{h(a.target.value.replace(/\D/g,"")),v("")},className:"w-full p-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none font-mono text-lg tracking-widest",required:!0,disabled:r})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Biografía"}),(0,b.jsx)(X,{placeholder:"Cuéntanos sobre tu experiencia...",value:i,onChange:a=>j(a.target.value),className:"w-full p-3 border-2 border-slate-200 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none",required:!0,disabled:r})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Foto de Perfil (para DNI)"}),o?(0,b.jsxs)("div",{className:"p-3 border-2 border-emerald-200 bg-emerald-50 rounded-lg flex items-center gap-3",children:[(0,b.jsx)(V,{className:"w-6 h-6 text-emerald-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-sm text-emerald-800",children:"Foto cargada"}),(0,b.jsx)("p",{className:"text-xs text-emerald-600 truncate",children:k})]})]}):(0,b.jsxs)("button",{type:"button",onClick:()=>{s(!0),setTimeout(()=>{l(`https://i.pravatar.cc/150?u=${g||Math.random()}`),q(!0),v(""),s(!1)},800)},disabled:r,className:"w-full p-6 border-2 border-dashed border-slate-300 rounded-lg flex flex-col items-center justify-center text-slate-500 hover:bg-slate-50 hover:border-indigo-500 hover:text-indigo-600 transition-colors",children:[(0,b.jsx)(W,{className:"w-8 h-8 mb-2"}),(0,b.jsx)("span",{className:"text-sm font-bold",children:"Subir una foto"}),(0,b.jsx)("span",{className:"text-xs",children:"Esto es una simulación"})]})]}),t&&(0,b.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex gap-2",children:[(0,b.jsx)(U,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-sm text-red-700",children:t})]}),(0,b.jsxs)("button",{type:"submit",disabled:r||8!==g.length||!i||!k,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[r&&"dni"===e?(0,b.jsx)(u.Loader,{className:"w-5 h-5 animate-spin"}):null,r&&"dni"===e?"Validando...":"Validar y Continuar"]})]}),"background"===e&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("h3",{className:"font-bold text-slate-800 mb-2",children:"Verificación de Antecedentes"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Estamos validando tu historial. Este proceso toma un momento."})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,b.jsx)(V,{className:"w-5 h-5 text-indigo-600"}),(0,b.jsx)("span",{className:"text-sm text-slate-700",children:"DNI, Biografía y Foto Verificados"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,b.jsx)(u.Loader,{className:"w-5 h-5 text-indigo-600 animate-spin"}),(0,b.jsx)("span",{className:"text-sm text-slate-700",children:"Antecedentes Penales"})]})]}),(0,b.jsxs)("button",{onClick:x,disabled:r,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-4",children:[r?(0,b.jsx)(u.Loader,{className:"w-5 h-5 animate-spin"}):null,r?"Verificando...":"Finalizar Verificación"]})]}),"success"===e&&(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)("div",{className:"flex justify-center mb-4",children:(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center",children:(0,b.jsx)(V,{className:"w-10 h-10 text-emerald-600"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Verificación Completada"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Tu identidad ha sido verificada. Ahora puedes trabajar como profesional en ProxHogar."})]}),(0,b.jsx)("button",{onClick:()=>a({biografia:i,fotoBiometricaReferenciaUrl:k,dni:g,antecedentesPenalesVerificados:m}),className:"w-full bg-emerald-600 text-white py-3 rounded-lg font-bold hover:bg-emerald-700",children:"Comenzar como Profesional"})]})]})]})})},Z=(0,r.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),$=(0,r.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var _=a.i(72692);let aa=(0,r.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ab=()=>{let{user:a,activeRole:d,logout:f,switchToWorkerRole:g}=(0,e.useAuth)(),[h,i]=(0,c.useState)("dashboard"),[j,k]=(0,c.useState)(!1),l=async a=>{try{await g(a),k(!1)}catch(a){console.error("Failed to switch to worker role from layout.")}};return(0,b.jsxs)("div",{className:"flex min-h-screen bg-slate-50 font-sans text-slate-900",children:[(0,b.jsxs)("aside",{className:"w-64 bg-white border-r hidden md:flex flex-col justify-between fixed h-full z-20",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"h-20 flex items-center px-8 border-b",children:(0,b.jsx)("span",{className:"font-bold text-xl",children:"ProxHogar"})}),(0,b.jsxs)("div",{className:"p-4 space-y-1",children:[(0,b.jsxs)("button",{onClick:()=>i("dashboard"),className:`w-full text-left px-4 py-3 rounded-xl flex gap-3 ${"dashboard"===h?"bg-indigo-50 text-indigo-700 font-bold":"hover:bg-slate-50"}`,children:[(0,b.jsx)(Z,{className:"w-5 h-5"})," Panel"]}),(0,b.jsxs)("button",{onClick:()=>i("planes"),className:`w-full text-left px-4 py-3 rounded-xl flex gap-3 ${"planes"===h?"bg-indigo-50 text-indigo-700 font-bold":"hover:bg-slate-50"}`,children:[(0,b.jsx)(D,{className:"w-5 h-5"})," Planes"]}),(0,b.jsxs)("button",{onClick:()=>i("profile"),className:`w-full text-left px-4 py-3 rounded-xl flex gap-3 ${"profile"===h?"bg-indigo-50 text-indigo-700 font-bold":"hover:bg-slate-50"}`,children:[(0,b.jsx)(N,{className:"w-5 h-5"})," Mi Perfil"]}),(0,b.jsxs)("div",{className:"mt-8 bg-slate-900 text-white p-4 rounded-xl",children:[(0,b.jsx)("p",{className:"text-xs opacity-50 mb-1",children:"Rol Actual"}),(0,b.jsx)("p",{className:"font-bold mb-3",children:d}),(0,b.jsxs)("button",{onClick:()=>{k(!0)},disabled:a?.hasChangedToWorker,className:"w-full bg-white/20 py-2 rounded text-xs flex justify-center gap-2 hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:a?.hasChangedToWorker?"El cambio de rol solo se puede realizar una vez.":"Convertirse en trabajador",children:[a?.esTrabajador?"Rol de Trabajador":"Cambiar a Trabajador"," ",(0,b.jsx)(aa,{className:"w-3 h-3"})]})]})]})]}),(0,b.jsx)("div",{className:"p-4 border-t",children:(0,b.jsxs)("button",{onClick:f,className:"flex gap-2 text-slate-500 hover:text-red-500",children:[(0,b.jsx)($,{className:"w-5 h-5"})," Salir"]})})]}),(0,b.jsxs)("main",{className:"flex-1 md:ml-64 p-8",children:[(0,b.jsxs)("header",{className:"flex justify-between items-center mb-8 md:hidden",children:[(0,b.jsx)("span",{className:"font-bold",children:"ProxHogar"}),(0,b.jsx)(_.Menu,{className:"w-6 h-6"})]}),"dashboard"===h?"CLIENTE"===d?(0,b.jsx)(I,{}):(0,b.jsx)(R,{}):"planes"===h?(0,b.jsx)(S,{}):"profile"===h?(0,b.jsx)(T,{}):null]}),j&&(0,b.jsx)(Y,{onSuccess:l,onCancel:()=>{k(!1)}})]})};function ac(){let{user:a,isLoading:f}=(0,e.useAuth)(),g=(0,d.useRouter)();return((0,c.useEffect)(()=>{f||a||g.push("/auth?mode=login")},[a,f,g]),f||!a)?(0,b.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-slate-950",children:(0,b.jsx)(u.Loader,{className:"w-8 h-8 animate-spin text-white"})}):(0,b.jsx)(ab,{})}a.s(["default",()=>ac],20731)}];

//# sourceMappingURL=app_dashboard_page_tsx_42ef5b16._.js.map